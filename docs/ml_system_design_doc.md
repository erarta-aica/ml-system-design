# Проект AICA - сервис расчитывающий калорийность еды по фотографии

---

## 1. Постановка задачи

### 1.1 Описание задачи
Цель проекта — разработать сервис, который позволяет пользователям рассчитывать калорийность блюд на основе загруженных фотографий. Система должна выполнять классификацию еды, оценивать её вес и на основании пищевой ценности продуктов предоставлять информацию о калориях. 

### 1.2 Основные пользователи
1. **Индивидуальные пользователи**:
   - Люди, следящие за своим питанием.
   - Спортсмены, подсчитывающие калории для достижения целей.
2. **Фитнес и диетологические сервисы**:
   - Приложения для управления питанием.
   - Медицинские учреждения для анализа диет пациентов.
3. **Рестораны и службы доставки**:
   - Для анализа популярности блюд и их калорийности.

### 1.3 Основные возможности
- Анализ изображения для определения типа еды.
- Оценка веса блюда.
- Расчет калорийности на основе предоставленных данных.
- История обработанных изображений с результатами.
- Возможность исправления данных пользователем.

### 1.4 Ключевые показатели качества
- **Точность классификации еды**: ≥ 90%.
- **Погрешность оценки веса**: ≤ 10%.
- **Скорость обработки**: ≤ 3 секунды.

### 1.5 Границы задачи
- Система поддерживает только отдельные блюда на одном изображении.
- Классификация ограничена списком из 200 категорий еды.
- Не учитываются дополнительные ингредиенты (например, соусы или гарниры).

---

## 2. Анализ данных

### 2.1 Источники данных
1. **Публичные датасеты**:
   - Food-101, FoodX-251 — изображения блюд с разметкой.
   - Таблицы пищевой ценности (например, USDA FoodData Central).
2. **Собственные данные**:
   - Собранные фотографии от пользователей.
   - Ручная аннотация изображений (тип блюда, вес, калорийность).
3. **Дополнительные источники**:
   - Изображения из социальных сетей (с соблюдением правил использования данных).

### 2.2 Предварительная обработка данных
- **Очистка данных**:
  - Удаление нерелевантных изображений (пустые тарелки, текст).
  - Фильтрация повреждённых и размытных изображений.
- **Аугментация**:
  - Вращение изображений.
  - Изменение яркости, контраста.
  - Добавление случайного шума.
- **Унификация формата**:
  - Преобразование изображений к размеру 224x224 пикселей.
  - Нормализация пикселей (0–1).

### 2.3 Этапы решения задачи

## Этап 1. Подготовка данных

### Описание данных и сущностей
* Набор фотографий блюд с размеченной калорийностью
* Метаданные: название блюда, вес порции, состав ингредиентов
* Выявленные проблемы:
  * Недостаточное разнообразие ракурсов съемки
  * Неравномерное освещение
  * Отсутствие стандартизации размера порций

### Процесс генерации данных
* Источники данных:
  * Food-101 датасет
  * Food-5K датасет
  * Ручная разметка экспертами-диетологами
  * Сбор через мобильное приложение
* Формат данных:
  * Изображения: JPG/PNG
  * Аннотации: JSON

### Работа с недостатком данных
* Требуется дополнительно 10000+ размеченных фотографий
* Методы решения:
  * Краудсорсинг через мобильное приложение
  * Data augmentation существующих данных
  * Синтетическая генерация данных
* Валидация качества через перекрестную проверку экспертами

### Конфиденциальность
* Отсутствие хранения персональных данных пользователей
* Анонимизация фотографий при загрузке
* Безопасное хранение метаданных без чувствительной информации

## Этап 2. Подготовка прогнозных моделей

### ML-метрики и функции потерь
* Основная метрика: Mean Absolute Percentage Error (MAPE)
* Дополнительные метрики:
  * MSE (Mean Squared Error)
  * RMSE (Root Mean Squared Error)
* Функция потерь: комбинация L1 и L2 для оптимального баланса точности

### Схема ML-валидации
* Стратифицированная 5-fold кросс-валидация
* Выделенный тестовый набор для финальной оценки
* Валидация на различных категориях блюд

### Структура бейзлайна
* Архитектура: CNN на базе ResNet50
* Предобработка данных:
  * Нормализация изображений
  * Аугментация данных
  * Resize до стандартного размера
* Базовые признаки:
  * Цветовые гистограммы
  * Текстурные характеристики

### Стратегии развития решения
* Тестирование современных архитектур:
  * EfficientNet
  * Vision Transformer
* Мультимодальный подход с учетом текстового описания
* Оптимизация гиперпараметров через Bayesian Optimization



Давайте заполним секцию "Подготовка пилота" в вашем дизайн-документе, ориентируясь на предоставленный шаблон. Мы сосредоточимся на описании механизма проведения пилота, способа оценки успешности и подготовительных шагов.

### 3. Подготовка пилота

#### 3.1. Способ оценки пилота

**Описание предполагаемого дизайна и способа оценки пилота:**

Пилотный проект будет оцениваться на основе заранее определенных метрик качества модели и бизнес-результатов. Мы будем использовать A/B тестирование для сравнения эффективности новой ML модели с текущими методами оценки калорийности. Основные метрики для оценки включают:

- **Точность классификации**: Доля правильно классифицированных изображений.
- **Средняя абсолютная процентная ошибка (MAPE)**: Для оценки точности предсказания калорийности.
- **Время обработки**: Среднее время, необходимое для обработки одного изображения.

#### 3.2. Что считаем успешным пилотом

**Формализованные в пилоте метрики оценки успешности:**

Пилот будет считаться успешным, если:

- **Точность классификации** достигнет или превысит 90%.
- **MAPE** будет менее 10% для более чем 80% категорий.
- **Время обработки** одного изображения не превысит 3 секунд.

Эти метрики будут сравниваться с текущими показателями, чтобы определить улучшение.

#### 3.3. Подготовка пилота

**Подготовительные шаги и вычислительная сложность:**

- **Подготовка данных**: Убедиться, что все данные правильно размечены и готовы для использования в модели. Провести дополнительную аугментацию данных для увеличения разнообразия.
- **Оценка вычислительной сложности**: Провести предварительные тесты с бейзлайн моделью для оценки вычислительных затрат. На основе этих данных определить оптимальные параметры для пилота.
- **Инфраструктура**: Использовать облачные ресурсы для масштабируемости и гибкости. Это позволит быстро адаптироваться к изменяющимся требованиям и нагрузкам.
- **Ограничения по вычислительной сложности**: Установить ограничения на использование ресурсов, чтобы избежать превышения бюджета на вычисления.

Google Colab: https://colab.research.google.com/drive/1E8UzmoRY9WAnFBOwGGQKpRGLvZO4jF0x?usp=sharing